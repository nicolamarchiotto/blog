version: '3'

services:
  # FILEBROWSER
  filebrowser:
    container_name: filebrowser
    image:  hurlenko/filebrowser
    restart: unless-stopped
    ports:
      - ${FILEBROWSER_PORT}:8080
    volumes:
      - ~:/data
      - ${DOCKER_CONFIGS_PATH}/filebrowser:/config
    networks:
      - medianetwork

  # JELLYFIN
  jellyfin:
    container_name: jellyfin
    image: lscr.io/linuxserver/jellyfin:latest
    restart: unless-stopped
    ports:
      - ${JELLYFIN_PORT}:8096
      - 8920:8920
      - 7359:7359/udp
      - 1900:1900/udp
    volumes:
      - ${DOCKER_CONFIGS_PATH}/jellyfin:/config
      - ${SHOWS_FOLDER}:/data/tvshows
      - ${MOVIES_FOLDER}:/data/movies
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Rome
    networks:
      - medianetwork
  
  #JACKETT
  jackett:
    image: lscr.io/linuxserver/jackett:latest
    container_name: jackett
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Rome
      - AUTO_UPDATE=true #optional
    volumes:
      - ${DOCKER_CONFIGS_PATH}/jackett:/config
      # - ${MEDIA_FOLDER}:/downloads
    ports:
      - ${JACKETT_PORT}:9117
    restart: unless-stopped
    networks:
      - medianetwork

  # PHOTOPRISM
  photoprism:
    container_name: photoprism
    image:  photoprism/photoprism:latest
    restart: unless-stopped
    ports:
      - ${PHOTOPRISM_PORT}:2342
    volumes:
      - ${DOCKER_CONFIGS_PATH}/photoprism:/photoprism/storage
      - ${PICTURES_FOLDER}:/photoprism/originals
    environment:
      - PHOTOPRISM_UPLOAD_NSFW = "true"
      - PHOTOPRISM_ADMIN_PASSWORD = "insecure" 
    networks:
      - medianetwork
  
  # SONARR
  sonarr:
    image: lscr.io/linuxserver/sonarr:latest
    container_name: sonarr
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Rome
    volumes:
      - ${DOCKER_CONFIGS_PATH}/sonar:/config
      - ${SHOWS_FOLDER}:/tv #optional
      - ${MEDIA_FOLDER}:/downloads #optional
    ports:
      - ${SONARR_PORT}:8989
    restart: unless-stopped
    networks:
      - medianetwork
  
  # RADARR
  radarr:
    image: lscr.io/linuxserver/radarr:latest
    container_name: radarr
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Rome
    volumes:
      - ${DOCKER_CONFIGS_PATH}/radar:/config
      - ${MOVIES_FOLDER}:/movies # optional 
      - ${MEDIA_FOLDER}:/downloads  # optional
    ports:
      - ${RADARR_PORT}:7878
    restart: unless-stopped
    networks:
      - medianetwork

  # QBITORRENT
  qbittorrent:
    image: lscr.io/linuxserver/qbittorrent:latest
    container_name: qbittorrent
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Rome
      - WEBUI_PORT=8080
    volumes:
      - ${DOCKER_CONFIGS_PATH}/qbittorrent:/config 
      - ${MEDIA_FOLDER}:/downloads
    ports:
      - ${QBITTORRENT_PORT}:8080
      - 6881:6881
      - 6881:6881/udp
    restart: unless-stopped
    networks:
      - medianetwork
  
  homer:
    image: b4bz/homer:latest
    container_name: homer
    ports:
      - ${HOMER_PORT}:8080
    volumes:
      - ./homer-config/assets/:/www/assets
    restart: unless-stopped
    networks:
      - medianetwork
    depends_on:
      - qbittorrent
      - filebrowser
      - jackett
      - radarr
      - sonarr
      - jellyfin
      - photoprism

# NETWORK DEFINITION
networks:
    medianetwork:
        name: medianetwork
        driver: bridge